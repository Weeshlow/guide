<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>openHAB - Guide | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="openHAB Integration">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="http://guide.openenergymonitor.org/integrations/openhab/">

    <meta property="fb:app_id" content="xxxxxxxxxxxxxxx">
    <meta property="og:title" content="openHAB">
    <meta property="og:site_name" content="Guide | OpenEnergyMonitor">
    <meta property="og:url" content="http://guide.openenergymonitor.org/integrations/openhab/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="openHAB Integration">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="openHAB">
    <meta name="twitter:description" content="openHAB Integration">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Guide | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
    <link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
    <link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
    <link rel="apple-touch-icon" href="/images/favicon-57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="/images/favicon-144.png">
    <meta name="msapplication-config" content="/images/browserconfig.xml">
    
    <script>
    src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $("button").click(function(){
        $("p").toggle();
    });
});
</script>

    
   
     <!--<link href='https://fonts.googleapis.com/css?family=Raleway:400,400italic,700' rel='stylesheet' type='text/css' -->

  </head>

  <body >

    <header>
      <div class="grid-wrapper">
  <div class="grid">

    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
  <a href="/" class="site-title">
    <!--<img width='40' src='/images/favicon-192x192.png'> -->
    <!--<span>Guide | OpenEnergyMonitor</span>-->
    <span style="color:#777;font-weight:bold;font-family:Arial;font-size:20">
Open</span><span style="color:#0699fa;font-weight:bold;font-family:Arial;font-size:20">EnergyMonitor</span>
  </a>
</div>


<div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
  <nav>
    <input type="checkbox" id="toggle">
<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
<ul class="menu pull-right">
  <li><a  href='/setup/'>Setup </a></li>
  <li>
    <a href="/applications/">Applications <i class="icon icon-caret-down"></i></a>
    <ul>
      <li><a  href='/applications/home-energy/'>Home Energy </a></li>
      <li><a  href='/applications/solar-pv/'>Solar PV </a></li>
    </ul>
  </li>
  <li><a  href='/integrations/'>Integrations </a></li>
  <li><a  href='/technical/'>Technical </a></li>

  <li>
   <a href="/help/">Help <i class="icon icon-caret-down"></i></a>
    <ul>
     <li><a  href='https://community.openenergymonitor.org/'>Forum </a></li>
    </ul>
  </li>
   <li><a  href='http://shop.openenergymonitor.com'>Shop <i class="icon icon-shopping-cart"></i> </a></li>

</ul>
  </nav>
</div>

  </div>
</div>
    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

          <article class="page">
  
    

  
  <header>
    <h1 class="title indent">
      openHAB
    </h1>
  </header>
  <hr class="divider">
  

  <p>Open Home Automation Bus (openHAB) is <em>“a vendor and technology agnostic open source automation software for your home”</em>. openHAB can run on an emonPi (Raspberry Pi) and is very flexible and can be configured for just about any home automation task. This high level of configurability can also make it seem quite hard to understand to start with.</p>

<p><strong><a href="http://www.openhab.org">http://www.openhab.org</a></strong></p>

<hr />

<p><strong>openHAB is pre-installed and setup on the latest emondSD Raspberry Pi images, see <a href="https://github.com/openenergymonitor/emonpi/wiki/emonSD-pre-built-SD-card-Download-&amp;-Change-Log">emonSD repository and change log</a>. If your running an emonSD image that includes openHAB browse to:</strong></p>

<h2 id="httpemonpi8080httpemonpi8080"><a href="http://emonpi:8080">http://emonpi:8080</a></h2>

<p><em>Substitite <code class="highlighter-rouge">emonpi</code> for your local emonpi’s IP address if hostname lookup does not work</em></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">Username</span><span class="pi">:</span> <span class="s2">"</span><span class="s">pi"</span>
<span class="s">Password</span><span class="pi">:</span> <span class="s2">"</span><span class="s">emonpi2016"</span>
</code></pre>
</div>

<p><img src="https://raw.githubusercontent.com/openenergymonitor/oem_openHab/master/images/web.png" alt="openHAB OpenEnergyMonitor" /></p>

<p>Pre installed on the emonPi is a skeleton config setup openHAB with to subscribe to data from the emonPi’s MQTT server (see <a href="/technical/mqtt/">MQTT docs</a>). For a full openHAB demo see the <a href="http://demo.openhab.org:8080/">openHAB Demo House</a>.</p>

<h3 id="configuring-openhab">Configuring OpenHAB</h3>

<p>openHAB is configured from three main files:</p>

<ul>
  <li><strong><code class="highlighter-rouge">openhab.cfg</code></strong></li>
  <li><strong><code class="highlighter-rouge">&lt;sitemap-name&gt;.items</code></strong></li>
  <li><strong><code class="highlighter-rouge">&lt;sitemap-name&gt;.sitemap</code></strong></li>
</ul>

<p><em>In the openHAB emonPi install instructions (see docs link below) we recommend cloning the oem_openHAB to the /home directory then soft linking the <code class="highlighter-rouge">items</code> and <code class="highlighter-rouge">sitemap</code> files to the relevant config locations in <code class="highlighter-rouge">/etc/openhab/configurations/</code>. This makes the files easier to edit</em></p>

<p>It’s possible to have multiple user interfaces defined by multiple sitemaps e.g oem.sitemap, kids.sitemap or admin.sitemap etc. The default sitemap is default e.g. <code class="highlighter-rouge">default.items</code> and <code class="highlighter-rouge">default.sitemap</code>.</p>

<h4 id="openhabcfg">openhab.cfg</h4>

<p>This is the overall config file located in <code class="highlighter-rouge">/etc/openhab/configurations/</code>. In this file global config is set such as security authentication and MQTT server setting. E.g. to connect to emonPi local MQTT server the following is added:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>mqtt:mosquitto.url=tcp://localhost:1883
mqtt:mosquitto.user=emonpi
mqtt:mosquitto.pwd=emonpimqtt2016
mqtt:mosquitto.qos=2
mqtt:mosquitto.retain=true
</code></pre>
</div>

<p>See the full openhab.cfg file used for this example on the open_openhab GitHub repo (see docs link below).</p>

<h4 id="items">Items</h4>

<p>The items file defines all the ‘things’ you might want to view or control in openHAB. Items can be bound to ‘bindings’ which are optional packages that used to extend functionality of openHAB. This example makes use of the MQTT and HTTP bindings. The items file is located in <code class="highlighter-rouge">/etc/openhab/configurations/items</code>.</p>

<p>For example the line in the items file to subscribe to <em>emonPi Power 1</em> from emonhub MQTT is as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Number emonpi_ct1 "Power 1 [%d W]" { mqtt="&lt;[mosquitto:emon/emonpi/power1:state:default]" }
</code></pre>
</div>

<p>The items file entry to <a href="/integrations/lightwaverf/">control LightWaveRF plug</a> (publish “1 1” to /lwrf mqtt topic) is as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Switch lwrf1 "LWRF Socket 1" {mqtt="&gt;[mosquitto:lwrf:command:ON:1 1],&gt;[mosquitto:lwrf:command:OFF:1 0]"}
</code></pre>
</div>

<p>See the full items file used for this example on the open_openhab GitHub repo (see docs link below).</p>

<h4 id="sitemap">Sitemap</h4>

<p>The second openHAB config file of interest is ‘sitemap’. Sitemaps are used to create elements of a user interface for making openHAB items accessible to the front-end interface.</p>

<p>For example the sitemap config line to produce the emonPi Power1 in the interface is as follows:</p>

<p><code class="highlighter-rouge">Text item=emonpi_ct1 icon="firstfloor"</code></p>

<p>And to produce the LightWaveRF control swithches:</p>

<p><code class="highlighter-rouge">Switch item=lwrf1 label="LWRF Plug 1"</code></p>

<p>See the full sitemap file used for this example on the open_openhab GitHub repo (see docs link below).</p>

<p>I have intentionally kept this ‘skeleton’ example as simple as possible. To view the full capabilities of openHAB including using groups checkout the openHAB demo and corresponding demo items and sitemap files.</p>

<h3 id="documentation--source-code">Documentation &amp; Source Code</h3>

<p><strong><a href="https://github.com/openenergymonitor/oem_openhab">emonPi openHAB</a></strong></p>

<h3 id="related-blog-posts">Related Blog Posts</h3>

<p><a href="https://blog.openenergymonitor.org/2015/12/openenergymonitor-emonpi-and-openhab/">OpenEnergyMonitor, emonPi and openHAB</a></p>


</article>


        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">

  

  
    <section class="aside-module grid__item one-whole lap-one-half">
  <div class='edit-github'><a href='https://github.com/openenergymonitor/guide/tree/master/source/integrations/openhab.markdown'>Edit on GitHub</a></div>
<div class='edit-github'><a href='http://prose.io/#openenergymonitor/guide/edit/master/source/integrations/openhab.markdown'>Edit on GitHub Prose</a></div>


  <div class='section'>
    <h1 class="title delta">Contents</h1>
    <ul class='divided sidebar-menu'>
      <li>
          <b>Setup</b>
        <ul>
          <li><a  href='/setup/'>Hardware </a></li>
          <li><a  href='/setup/connect/'>Connect </a></li>
          <li><a  href='/setup/install/'>Install </a></li>
          <li><a  href='/setup/local/'>Log Locally </a></li>
          <li><a  href='/setup/remote/'>Log Remotely </a></li>
          <li><a  href='/setup/dashboards/'>Dashboards </a></li>
          <li><a  href='/setup/emontx/'>Add Energy Sensing Node(s) </a></li>
          <li><a  href='/setup/emonth/'>Add Temperature Node(s) </a></li>
          <li><a  href='/setup/optical-pulse-sensor/'>Add Optical Pulse Sensor </a></li>
          <li><a  href='/setup/import/'>Import / Backup </a></li>
          <li><a  href='/setup/north-america/'>Use in North America </a></li>
          <li><a  href='/setup/troubleshooting/'>Troubleshooting </a></li>
        </ul>
        <li>
          <b>Emoncms</b>
          <ul>
          <li><a  href='/setup/daily-kwh'>Daily kWh </a></li>
          <li><a  href='/setup/daily-averages'>Daily Averages </a></li>
          <li><a  href='/setup/export-csv'>Exporting CSV </a></li>
          <li><a  href='/setup/histograms'>Histograms </a></li>
          <li><a  href='/technical/api/'>Emoncms API </a></li>
        </ul>


      </li>

      <li>
         <b>Applications</b>
        <ul>
         <li><a  href='/applications/home-energy/'>Home Energy </a></li>
         <li><a  href='/applications/solar-pv/'>Solar PV </a></li>
         <li><a  href='http://heatpumpmonitor.org/'>Heatpump <i class="icon-external-link"></i> </a></li>
        </ul>
      </li>

      <li>
         <b>Integrations</b>
        <ul>
         <li><a  href='/integrations/nodered/'>Node-RED </a></li>
         <li><a class='active' href='/integrations/openhab/'>OpenHAB </a></li>
         <li><a  href='/integrations/mqtt-relay/'>Control Relay </a></li>
         <li><a  href='/integrations/lightwaverf/'>LightWave RF Control </a></li>
        </ul>

      <li>
        <b>Technical</b>
       <ul>
        <li><a  href='/technical/'>Overview </a></li>
        <li><a  href='/technical/specifications/'>Specifications </a></li>
        <li><a  href='/technical/credentials/'>Service Credentials </a></li>
        <li><a  href='/technical/mqtt/'>MQTT </a></li>
        <li><a  href='/technical/compiling/'>Firmware Modification </a></li>
        <li><a  href='/technical/resources/'>Resources </a></li>
       </ul>
      </li>

      <li>
     <b>Support</b>
        <ul>
         <li><a  href='https://community.openenergymonitor.org/latest'>Community Forum <i class="icon-external-link"></i> </a>
         <li><a  href='/help/'>Contact </a></li>
        </ul>
      </li>


    </div>
<gcse:search></gcse:search>
</section>
    <section class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta"<li><a href='https://openenergymonitor.org' target="_blank">OpenEnergyMonitor <i class="icon-external-link"></i></h1>
  <ul class="divided">
    <li>
      A project to develop <a href='https://openenergymonitor.org/emon/opensustech'>open-source tools</a> to help us relate to our use of energy, our energy systems and the challenge of <a href='https://openenergymonitor.org/emon/sustainable-energy'>sustainable energy</a>.
    </li>
    
  </ul>
  <p>
  <h1 class="title delta"<li><a href='https://emoncms.org' target="_blank">Emoncms <i class="icon-external-link"></i></a></li></h1>
  <ul class="divided">
    <li>
      Emoncms is a powerful <a href='https://github.com/emoncms'>open-source</a> web-app for processing, logging and visualising energy, temperature and other environmental data.
    </li>
  </ul>
</section>
  

    
</div>
        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <style>


div.searchtool {
  position: relative;
  display: inline-block;
  top: -6px;
}

input[type=text] {
  border: 3px solid #0699fa;
}

fieldset {
  border: 0;
}

</style>
<div class="copyright">

  <a rel="me" href='https://twitter.com/openenergymon'><i class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor/guide'><i class="icon-github"></i></a>
  <a rel="me" href='http://blog.openenergymonitor.org'><i class="icon-bullhorn"></i></a>

  <div class="credit">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and <a href='https://github.com/coogie/oscailte'>Oscalite</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>

<div class="searchtool">


<form action="https://encrypted.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:guide.openenergymonitor.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search..." />
  </fieldset>
</form>


</div>
</div>
    </div>
  </div>
</div>
    </footer>

    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <script>
  var _gaq=[['_setAccount','UA-10321170-5'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>



<script>
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

  </body>
</html>